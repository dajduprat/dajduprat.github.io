/*! For license information please see commands.js.LICENSE.txt */
!function(){function e(){var r,t,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function u(e,o,a,c){var u=o&&o.prototype instanceof s?o:s,f=Object.create(u.prototype);return n(f,"_invoke",function(e,n,o){var a,c,u,s=0,f=o||[],l=!1,d={p:0,n:0,v:r,a:p,f:p.bind(r,4),d:function(e,n){return a=e,c=0,u=r,d.n=n,i}};function p(e,n){for(c=e,u=n,t=0;!l&&s&&!o&&t<f.length;t++){var o,a=f[t],p=d.p,y=a[2];e>3?(o=y===n)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=r):a[0]<=p&&((o=e<2&&p<a[1])?(c=0,d.v=n,d.n=a[1]):p<y&&(o=e<3||a[0]>n||n>y)&&(a[4]=e,a[5]=n,d.n=y,c=0))}if(o||e>1)return i;throw l=!0,n}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&p(f,y),c=f,u=y;(t=c<2?r:u)||!l;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=r}else if((t=(l=d.n<0)?u:e.call(n,d))!==i)break}catch(e){a=r,c=1,u=e}finally{s=1}}return{value:t,done:l}}}(e,a,c),!0),f}var i={};function s(){}function f(){}function l(){}t=Object.getPrototypeOf;var d=[][a]?t(t([][a]())):(n(t={},a,function(){return this}),t),p=l.prototype=s.prototype=Object.create(d);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,n(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e}return f.prototype=l,n(p,"constructor",l),n(l,"constructor",f),f.displayName="GeneratorFunction",n(l,c,"GeneratorFunction"),n(p),n(p,c,"Generator"),n(p,a,function(){return this}),n(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:u,m:y}})()}function n(e,r,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}n=function(e,r,t,o){function c(r,t){n(e,r,function(e){return this._invoke(r,t,e)})}r?a?a(e,r,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[r]=t:(c("next",0),c("throw",1),c("return",2))},n(e,r,t,o)}function r(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){i=!0,c=e},f:function(){try{u||null==r.return||r.return()}finally{if(i)throw c}}}}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}function o(e,n,r,t,o,a,c){try{var u=e[a](c),i=u.value}catch(e){return void r(e)}u.done?n(i):Promise.resolve(i).then(t,o)}function a(e){return function(){var n=this,r=arguments;return new Promise(function(t,a){var c=e.apply(n,r);function u(e){o(c,t,a,u,i,"next",e)}function i(e){o(c,t,a,u,i,"throw",e)}u(void 0)})}}function c(){return u.apply(this,arguments)}function u(){return u=a(e().m(function n(){return e().w(function(n){for(;;)if(0===n.n)return n.a(2,Excel.run(function(){var n=a(e().m(function n(r){var t,o,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(t=r.workbook.getSelectedRanges()).worksheet.load({id:!0,name:!0}),t.areas.load({address:!0}),e.p=1,e.n=2,r.sync();case 2:e.n=5;break;case 3:if(e.p=3,!((o=e.v)instanceof Error&&(o.message.includes("Wait until")||o.message.includes("is currently busy")))){e.n=4;break}return console.warn("Excel is busy. Could not get selected ranges. ".concat(o.message)),e.a(2,[]);case 4:throw o;case 5:return e.a(2,t.areas.items.map(function(e){return{address:e.address,worksheet:{id:t.worksheet.id,name:t.worksheet.name}}}));case 6:return e.p=6,a=e.v,console.error("Error in getSelectedRanges: ".concat(a)),e.a(2,[])}},n,null,[[1,3],[0,6]])}));return function(e){return n.apply(this,arguments)}}()))},n)})),u.apply(this,arguments)}function i(e,n,r){return s.apply(this,arguments)}function s(){return(s=a(e().m(function n(r,t,o){var a,c,u,i;return e().w(function(e){for(;;)switch(e.n){case 0:if(!(r.indexOf(",")>-1)){e.n=1;break}a=t.getRanges(r),e.n=3;break;case 1:return c=t.getRange(r),u=t.getUsedRange(),i=c.getIntersectionOrNullObject(u),e.n=2,o.sync();case 2:a=i.isNullObject?c:i;case 3:return e.a(2,a)}},n)}))).apply(this,arguments)}Office.onReady(function(){}),Office.actions.associate("onCalculateRibbonClick",function(n){Excel.run(function(){var n=a(e().m(function n(t){var o,a,u,s,f,l,d,p;return e().w(function(e){for(;;)switch(e.n){case 0:return(o=t.workbook.worksheets.getActiveWorksheet()).load(["id","name"]),e.n=1,t.sync();case 1:return e.n=2,c();case 2:a=e.v,u=a.map(function(e){return e.address}).join(","),s=[],f=r(a);try{for(f.s();!(l=f.n()).done;)d=l.value,(p=o.getRange(d.address)).load(["formulas","address","columnIndex","rowIndex"]),s.push(p)}catch(e){f.e(e)}finally{f.f()}return e.n=3,t.sync();case 3:return e.n=4,i(u,o,t);case 4:return e.v.calculate(),e.n=5,t.sync();case 5:console.log("Calculation completed for selected range");case 6:return e.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}()),n.completed()}),Office.actions.associate("onSafeCalculateRibbonClick",function(n){var t=this;Excel.run(function(){var n=a(e().m(function n(o){var a,u,s,f,l,d,p,y,v,h;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return(a=o.workbook.worksheets.getActiveWorksheet()).load(["id","name"]),e.n=1,o.sync();case 1:return e.n=2,c();case 2:u=e.v,s=u.map(function(e){return e.address}).join(","),f=[],l=r(u);try{for(l.s();!(d=l.n()).done;)p=d.value,(y=a.getRange(p.address)).load(["formulas","address","columnIndex","rowIndex"]),f.push(y)}catch(e){l.e(e)}finally{l.f()}return e.n=3,o.sync();case 3:return e.n=4,i(s,a,o);case 4:return v=e.v,e.p=5,v.calculate(),e.n=6,o.sync();case 6:e.n=10;break;case 7:if(e.p=7,"ItemNotFound"!==(null==(h=e.v)?void 0:h.code)){e.n=9;break}return t._logger.warn("Range reference became stale, getting fresh reference for calculation"),e.n=8,i(s,a,o);case 8:e.v.calculate(),e.n=10;break;case 9:throw h;case 10:console.log("Calculation completed for selected range");case 11:return e.a(2)}},n,null,[[5,7]])}));return function(e){return n.apply(this,arguments)}}()),n.completed()})}();
//# sourceMappingURL=commands.js.map